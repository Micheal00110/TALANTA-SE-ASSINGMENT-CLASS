<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register - Library Management</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h2>Register</h2>
        <div id="message" class="message"></div>
        <input type="text" id="username" placeholder="Username" required>
        <input type="password" id="password" placeholder="Password" required>
        <select id="role">
            <option value="user">User</option>
            <option value="librarian">Librarian</option>
        </select>
        <button onclick="register()">Register</button>
        <p>Already have an account? <a href="login.html">Login here</a>.</p>
    </div>

    <script>
        // Seed a default librarian if no users exist
        (function seedAdmin() {
            const users = JSON.parse(localStorage.getItem('users')) || [];
            if (users.length === 0) {
                users.push({ username: 'admin', password: 'password', role: 'librarian' });
                localStorage.setItem('users', JSON.stringify(users));
                console.log('Default admin user created. Username: admin, Password: password');
            }
        })();

        function register() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            const role = document.getElementById('role').value;
            const message = document.getElementById('message');

            if (!username || !password) {
                message.textContent = 'Please enter both username and password.';
                message.className = 'error';
                return;
            }

            const users = JSON.parse(localStorage.getItem('users')) || [];
            if (users.some(u => u.username === username)) {
                message.textContent = 'Username already exists.';
                message.className = 'error';
                return;
            }

            users.push({ username, password, role });
            localStorage.setItem('users', JSON.stringify(users));
            message.textContent = 'Registration successful! Redirecting to login...';
            message.className = 'success';
            setTimeout(() => { window.location.href = 'login.html'; }, 1500);
        }
    </script>
</body>
</html>